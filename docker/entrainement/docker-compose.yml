version: '3'

services:
  entrainement:
    image: alexluneau/entrainement
    networks:
      - rakuten_network
     
    deploy:
      resources:
        reservations:
          devices:
          - driver: nvidia
            capabilities: [gpu]

    environment:
      - MLFLOW_TRACKING_URI=http://mlflow-server:5000
      - path_input_data=/app/data/
      - path_images_train=/app/data/image_train
      - path_images_test=/app/data/image_test
      - path_model=/app/models_entrainement
      - path_mlflow=/app/MLflow
    volumes:
      #- ../rclone/data:/app/data
      - /mnt/d/MLops_Rakuten/data:/app/data ##Pour essayer sur les images stock√©es en local
      - ../rclone/data/MLflow:/app/MLflow
      #- ../rclone/data/models_entrainement:/app/models_entrainement
      - /mnt/d/MLops_Rakuten/data/models_entrainement:/app/models_entrainement



networks:
  rakuten_network:
     #driver : bridge
    external: true
